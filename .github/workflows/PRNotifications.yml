name: Pull Request Notification

on:
    pull_request: 
        branches: 
            - develop
            - main

jobs: 
  Build-Verification:
    runs-on: ubuntu-latest
    steps:
        - name: Checkout code
          uses: actions/checkout@v4

        - name: Setup Node.js
          uses: actions/setup-node@v4
          with:
            node-version: '18'

        - name: Install dependencies and build
          run: |
            npm install
            npm run build

  PR-Notification:
    runs-on: ubuntu-latest
    steps:
        - uses: actions/checkout@v2
      
      
        - name: Set branch name
          id: branch-name
          run: |
            echo "BRANCH_NAME=$(echo ${{ github.head_ref }} | sed 's/refs\/heads\///')" >> $GITHUB_ENV
            echo "BRANCH_NAME_DEST=$(echo ${{ github.event.pull_request.base.ref }} | sed 's/refs\/heads\///')" >> $GITHUB_ENV

        - name: Discord Webhook Action for PR
          uses: tsickert/discord-webhook@v5.3.0
          with:
            webhook-url: ${{ secrets.DISCORD_WEBHOOK }}
            embed-title: "âœ¨ Â¡Un Pull Request estÃ¡ aquÃ­ para revisiÃ³n! âœ¨"
            embed-color: "3447003" # Azul para una sensaciÃ³n profesional y confiable
            embed-description: |
                ğŸ‘‹ **Hola equipo**, Â¡tenemos un nuevo Pull Request (PR) en nuestro repositorio! AquÃ­ estÃ¡n los detalles para que todos estemos al dÃ­a y podamos colaborar:
        
                ğŸ“‚ **Repositorio:**  
                Este PR pertenece al repositorio [${{ github.event.repository.name }}](${{ github.event.repository.url }}).
        
                ğŸ“ **TÃ­tulo del PR:**  
                _"${{ github.event.pull_request.title }}"_  
                Este tÃ­tulo describe brevemente los cambios propuestos. Â¡Echa un vistazo!
        
                ğŸŒ **Enlace directo:**  
                Puedes revisar los detalles completos del PR y dejar tus comentarios aquÃ­: [Ver Pull Request](${{ github.event.pull_request.html_url }})
        
                ğŸ”„ **Detalles del flujo de trabajo:**  
                - **Branch de origen:** `$BRANCH_NAME`  
                - **Branch de destino:** `$BRANCH_NAME_DEST`  
                Esto muestra de dÃ³nde vienen los cambios y hacia dÃ³nde van. AsegÃºrate de que todo encaje correctamente.
        
                ğŸ“œ **Resumen de cambios:**  
                Los cambios propuestos estÃ¡n disponibles para revisiÃ³n detallada: [Explorar Cambios](${{ github.event.pull_request._links.html.href }}).  
                Puedes ver los archivos actualizados y evaluar si cumplen con los objetivos del proyecto.
        
                ğŸ‘¤ **Autor del PR:**  
                Este PR fue creado por **${{ github.event.pull_request.user.login }}**.  
                Puedes ver su perfil aquÃ­: [Perfil del Autor](${{ github.event.pull_request.user.html_url }})
        
                ğŸ¯ **Â¿QuÃ© sigue?**  
                - **Revisar el PR:** Ve al enlace y verifica los cambios.  
                - **Dejar comentarios:** Si tienes sugerencias o encuentras algo que deba ajustarse, Â¡no dudes en mencionarlo!  
                - **Aprobar o solicitar cambios:** Una vez que estÃ©s conforme, puedes aprobar el PR o solicitar ajustes antes de que se fusione.
        
                ğŸŒŸ **Gracias por tu colaboraciÃ³n**  
                Cada revisiÃ³n y comentario cuenta para que nuestro proyecto sea mejor. Â¡Sigamos construyendo algo increÃ­ble juntos! ğŸš€
            embed-author-name: "${{ github.event.pull_request.user.login }}"
            embed-author-url: "${{ github.event.pull_request.user.html_url }}"
            embed-author-icon-url: "${{ github.event.pull_request.user.avatar_url }}" 